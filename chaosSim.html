<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>Regular Traffic Simulation</title>
    <script type="text/javascript"
            src = "simpleGame.js"></script>
	<script type="text/javascript" src = "controller.js"></script>
	<script type="text/javascript" src = "spawner.js"></script>
        <script type="text/javascript" src = "car.js"></script>
	
    
    <script type="text/javascript">
        var control;
        var spawn;
	var sim;

	//Sim constants
	var SITUATION = 2; //second simulation file. NO TRAFFIC CONTROL
	var TRAINING = 0; //if training mode
	var CONTROLLING = 1; //not sure
	var CHAOS = 2; //this mode has no controlling, controller only records STATS
	var MONITORING = 2; //not sure
	var runTimes = 100;
	var curRun = 0;
        var runTime = 0;
        
        function init()
        {
	    sim = new Scene();
	    sim.setSize(1500,150);
			
			//Initialze controller
            control = new Controller(CHAOS);
			control.clearData();
			control.resetSimulation();
			
            //Initialize spawner with the appropriate simulation constant
            spawn = new Spawner(SITUATION, control);
			spawn.setPosition(750, 75);
			
			sim.start();
		}
        
        function update()
        {
            var time = runTime/20;
            document.getElementById('time').innerHTML = "Time: " + time.toFixed(1);
            
            //make first car in third lane slow (carId == 8)
            /*if(time > 9 && time < 11)
            {
                for(var i = 0; i < control.cars.length; i++)
                {
                    if(control.cars[i].carId == 2 && control.cars[i].getSpeed() > .5)
                    {
                        control.cars[i].changeSpeedBy(-.75);
                    }
                }
            } else if (time > 11)
            {
                for(var i = 0; i < control.cars.length; i++)
                {
                    if(control.cars[i].carId == 2 && control.cars[i].getSpeed() < control.cars[i].topSpeed)
                    {
                        control.cars[i].accel();
                    }
                }
            }*/
            
            if (curRun < runTimes) {
                    spriteList.update();
                    control.update();
                    
                    if(control.simulationFinished) {
                                 control.resetSimulation();
                                 spawn.reset();
                                 curRun ++;
                                 runTime = 0;
                    } // end if
            } // end if
            runTime++;
        }
    </script>

</head>

<body onload="init()">
    <div id="time"></div>
</body>
</html>