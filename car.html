<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>Traffic 1</title>
    <script type="text/javascript"
            src = "simpleGame.js"></script>
	<script type="text/javascript" src = "controller.js"></script>
    
    <script type="text/javascript">
        var game;
        var slowCar, fastCar;
        var LANE_ONE = 37.5;
        var LANE_TWO = 112.5;
        var LANE_THREE = 187.5;
        var LANE_FOUR = 262.5;
        var FOLLOW_MULT = 80; //follow distance is given in car lengths, must multiply by factor
    
    function Car(carID,desiredSpeed, startLane, destLane, accel, decel, maxSpeed, followDist)
    { 
        car = new Sprite(scene, "car.jpg", 75,40);
        car.setAngle(90);
        car.setImgAngle(0);
        car.maxSpeed = maxSpeed;
        car.minSpeed = 0;
        car.desiredSpeed = desiredSpeed;
        car.accel = accel;
        car.decel = decel;
        
        car.carID = carID;
        car.Lane = startLane;
		car.destLane = destLane;
        car.followDist = ((followDist+1)*FOLLOW_MULT); // car lengths times length of car plus half of car length
        car.setPosition(10,startLane);
        
        //return current lane of caar
        car.getLane = function()
        {
            return car.Lane;
        }
		
		car.changeLaneBy = function(dLane)
		{
			car.Lane += dLane;
		}
        
        //checking if the car can/should accelerate
        car.accel = function()
        {
            //console.log("accel");
            car.changeSpeedBy(car.accel);
        } //end accel
        
        //checking if the car should decel
        car.decel = function()
        {
            //if the dist to next car is approaching the following distance
            //  but is still greater than goal follow distance
            
            car.changeSpeedBy(car.decel);
            //console.log("decel");
            
            if(car.speed < 0)
            {
                car.setSpeed(0);
            }
        } //end decel
        
        //Emergency stop called by the controller
        car.eStop = function()
        {
            if(this.speed > 0)
            {
                car.changeSpeedBy(car.decel - .25);
            }
        }
        
        return car;
    }
    
    function Road()
    {
        road = new Sprite(scene, "road.png",800,300);
        road.setPosition(400,150);
    }
    
    function init()
    {
        
    }
    
    function update()
    {
        
    }
    </script>
</head>

<body onload="init()">
    
</body>

</html>